{% extends "base.html" %}

{% block head %}
<script>
    async function deleteLink(id) {
        try {
            const response = await fetch(`http://127.0.0.1:8000/delete/${id}`, {
                method: 'DELETE',
                headers: {
                    'Content-Type': 'application/json'
                }
            });
            if (response.ok) {
                window.location.reload();
            } else {
                wrongCredentialsSpan.textContent = "Выполните вход или зарегистируйтесь."
            }
        } catch(error) {
            wrongCredentialsSpan.textContent = "Ошибка соединения с сервером.";
        }
    }
</script>
{% endblock %}

{% block content %}
<style>
    .link-item {
        background-color: #f4f4f4;
        padding: 10px;
        margin-bottom: 10px;
    }
    .short-url {
        color: #FF5733 ;
    }
    .long-url {
        color: #900C3F;
        margin-top: 5px;
    }
    .delete-url {
        color: #581845;
        margin-top: 5px;
    }
</style>
<div class="flex flex-col items-center">
    <div class="link-item text-center">
        <div><strong>Мои ссылки</strong></div>
    </div>
    <ul class="list-none text-left">
        {% for link in user_links['user_urls'] %}
        <li class="text-2xl font-bold mb-6">
            <div class="link-item">
                <div class="short-url">Короткая: {{ link.short_url }}</div>
                <div class="long-url">Полная: {{ link.long_url }}</div>
                <a class="delete-url" href="#" onclick="deleteLink({{ link.id }})">Удалить</a>
            </div>
        </li>
        
        {% endfor %}
    </ul>
</div>
<nav aria-label="Страницы">
    <ul class="pagination justify-content-center">
        {% for i in range(1, (user_links.total // user_links.size) + 2) %}
            {% if (i != (user_links.total // user_links.size) + 1) or (user_links.total % user_links.size != 0) %}
                <li class="page-item {% if i == user_links.page %}active{% endif %}">
                <a class="page-link" href="?page={{ i }}&size={{ user_links.size }}">{{ i }}</a>
                </li>
            {% endif %}
        {% endfor %}
    </ul>
</nav>

{% endblock  %}